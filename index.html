<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ó–∞–≥—Ä—É–∑—á–∏–∫ –§–°–ò–ù</title>
  <style>
    body { font-family: Arial; background: #121212; color: #eee; padding: 20px; }
    input, textarea, button { display: block; margin: 10px 0; width: 100%; padding: 10px; border-radius: 5px; }
    textarea { height: 150px; }
    label { margin-top: 15px; font-weight: bold; }
  </style>
</head>
<body>

  <h2>üìù –û—Ç—á—ë—Ç –ø–æ –£–î–û</h2>

  <label>–í–∞—à–µ –ò–º—è_–§–∞–º–∏–ª–∏—è</label>
  <input id="officerName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Ivan_Rainhardt">

  <label>–ò–º—è –∑–∞–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ</label>
  <input id="prisonerName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Petrov_Ivan">

  <label>–°—É–º–º–∞ (–∫–∞–∑–Ω–∞)</label>
  <input id="amount" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 15000$">

  <label>–î–∞—Ç–∞</label>
  <input id="date" type="date">

  <label>–°–∫—Ä–∏–Ω—à–æ—Ç –¥–ª—è –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è</label>
  <input type="file" id="screenshot" accept="image/*">

  <button onclick="generateReport()">–û—Ñ–æ—Ä–º–∏—Ç—å BB-–∫–æ–¥</button>

  <textarea id="result" placeholder="BB-–∫–æ–¥ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å..." readonly></textarea>

  <script>
    async function uploadToCatbox(file) {
      const form = new FormData();
      form.append("reqtype", "fileupload");
      form.append("userhash", ""); // –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
      form.append("fileToUpload", file);

      const res = await fetch("https://catbox.moe/user/api.php", {
        method: "POST",
        body: form,
      });

      const text = await res.text();
      if (!text.startsWith("https://")) throw new Error("Catbox upload failed");
      return text;
    }

    async function generateReport() {
      const officer = document.getElementById("officerName").value;
      const prisoner = document.getElementById("prisonerName").value;
      const amount = document.getElementById("amount").value;
      const date = document.getElementById("date").value;
      const file = document.getElementById("screenshot").files[0];
      const resultArea = document.getElementById("result");

      if (!officer || !prisoner || !amount || !date || !file) {
        resultArea.value = "‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª.";
        return;
      }

      resultArea.value = "‚è≥ –ó–∞–≥—Ä—É–∂–∞—é —Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞ Catbox...";
      try {
        const imgUrl = await uploadToCatbox(file);
        const bbcode = `[center][size=12]–Ø, ${officer}, –ø–æ–ª—É—á–∏–ª —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ –∑–∞—è–≤–ª–µ–Ω–∏—è –Ω–∞ –£–î–û –æ—Ç:
–ó–∞–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ, ${prisoner}
${amount}
${date}
[img]${imgUrl}[/img][/size][/center]`;
        resultArea.value = bbcode;
      } catch (e) {
        resultArea.value = "‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ Catbox.";
      }
    }
  </script>

</body>
</html>
